---
bibliography: [references.bib]
---

# Software used in this project
## MCell and how it simulates reactions in 3D
MCell (Monte Carlo Cell) is a biochemistry simulation tool that uses spatially realistic 3D cellular models and stochastic Monte Carlo algorithms to simulate the movements and interactions of discrete molecules within and between cells, @bartol2000Monte, @kerr2008FAST, @bartol2015Computational. MCell is a particle-based simulator that represents molecules as point particles in 3D space. At every time step in an MCell simulation, each particle can move, collide with other particles or surfaces, and undergo bimolecular and unimolecular reactions. The basic elements of a simulation step are as seen in @fig-mcell-comp taken from @gupta2018Spatial.

![MCell Components. (A) Volume Molecules diffusing in free space. (B) Mesh Object defined by a Plane with Surface Molecules diffusing on it. (C) Mesh Object defined by a complex closed mesh with multiple defined Surface  Regions, in which Surface Molecules have different diffusion constants, as defined by corresponding Surface Classes.](background_figures/mcell_comp.png){#fig-mcell-comp}

Briefly, MCell operates as follows: as a volume molecule diffuses, all molecules within a given radius along its trajectory, or at the point of collision on a surface, are considered for a reaction. For surface molecules (in membranes), the molecule first diffuses, and then its neighbours are evaluated for reaction. There is no volume exclusion for molecules diffusing in 3D volumes, and molecules on surfaces occupy a  fixed area. MCell allows defining arbitrary geometry @fig-mcell-comp (C), and complex models such as a 180μm3 3DEM reconstruction of hippocampal neuropil have been used to construct a geometrically-precise simulation of 100s of neuronal synapses at once @bartol2015Computational. A detailed description of mathematical foundations of MCell’s algorithms can be found here: @bartol2000Monte, @kerr2008FAST, @bartol2015Computational.

MCell4, the version used in this project, is a new C++ implementation of MCell that provides a versatile Python interface in addition to other improvements. MCell 4 provides two different user experiences, one through its visual interface as an add-on in Blender 2.93, known as CellBlender, the other user experience one through a new Python interface (Husar et al., 2022). This provides users with the flexibility to change between both experiences, or to run the simulations using Python and visualize the simulations in Blender. CellBlender (Figure 16) is a Blender addon that allows creation and visualization of MCell4 models (https://MCell.org). CellBlender has some very helpful new features, which are: automatic generation of well-structured Python code for complete MCell4 models from their CellBlender representations, execution and visualization of these models, and visualization of simulation runs from externally created Python-only models. CellBlender offers an easy way how to start with MCell through built-in examples and tutorials (https://MCell.org) @husar2022MCell4. 

Furthermore, support for the file format MDL that older versions of MCell had, is also provided for backwards compatibility. In particular MCell4 is significantly faster when dealing with complex reaction networks expressed as rules in BNGL. MCell4 implements a BNGL library which enables direct loading and parsing of  BNG model and using it in realistic 3D cellular geometry, i.e. reactions can be written following BNG syntax, and therefore models can be exported from MCell and imported in BioNetGen for simulation and vice versa, integrating two different simulation engines. This allows simulation and comparison of results of non-spatial (simulated with BNG solvers) and spatial (simulated with MCell4) implementations of the same BNG model. 

A newly created BNG library is what allows direct loading and parsing of a BNG model into MCell and allows for using its realistic 3D geometry features. Additionally, as all MCell models can now be created in Python,  we are enabled to create more complicated customized models. In this project, a model was written in BNGL (which does not account for space dynamics), and this same model can then be parsed through MCell  (which does account for space dynamics) using a python script that calls up on it and runs it using the BNG library; this allows for smooth integration of the same model into different software. Hence, with a BNGL multimeric CaMKII model in place, we can now run a multistate model in MCell too, which was not possible just a few years ago. This will enable the model to have a 3D space aspect, which is something that modelling with BNG alone lacks. Most importantly, the support for BNGL and network-free simulation algorithms means that MCell4 allows direct, agent-based evaluation of reaction rules and thus enables spatially-resolved network-free simulations of interactions between and among volume and surface molecules. A CaMKII model would not be possible without the spatial network-free simulation allowed by MCell4. So, with all this information, why use one or another or both? An important point to understand here is that the spatial aspect of MCell can make  simulations slower than BNG simulations, and therefore BNG can be used for quicker development and testing, and then MCell can be used when we want to look at spatial effects. 

## Biodynamo

So now it is possible to model a CaMKII dodecamer in a 3D environment, but what about the dynamic reshaping of a neuron which happens during LTP as explained at the beginning of this report? CaMKII interacts with the actin cytoskeleton, which is responsible for the shape and size of the dendritic spine, @okamoto2007Role. In order to study this dynamic reshaping, Biodynamo helps solve this  challenge, as it can model changes in shape of cells, for example dendrite growth. Biodynamo (Biology Dynamics Modeller) is an agent-based modelling tool which can model 3D biophysical molecular interactions, @breitwieser2021BioDynaMo. To demonstrate the possibility of using Biodynamo as a tool to simulate neuronal growth through formation of an actin cytoskeleton inside dendritic spines, I helped with supervision of a project that carried out by Adrian Trajlinek (Reference not published). The model works with actin filaments represented as molecular agents with cylindrical shapes. These can then be modelled to support tree-like structures that can branch out, sever, polymerize and depolymerize in similar manners to the biological equivalent. Overall, this project provided proof of concept that actin dynamics can be modelled in Biodynamo, and further research can be developed from here onwards. Tools like MCell+CellBlender, Biodynamo and RuleBender provide an exciting prospect of modelling how the morphology of dendritic spines changes during synaptic plasticity. Together, they provide tools to build a general-purpose platform for large-scale biological simulations.
