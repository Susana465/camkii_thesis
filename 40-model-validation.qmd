# Validating model behaviour {#sec-validating-model}

In order to validate the model, I did five main things: 

1-> model closeness to reality, biological plausibility.
2-> model was built incrementally

4 -> Kinetic parameters used in the model's reactions were sourced from the literature or inferred from experimental data where available. In cases of uncertainty, parameter exploration was conducted to assess how kinetic rates impact model behaviour (see @sec-SA).

## Biological Plausibility
While care was taken to compare model outputs with known biological processes described in the literature and supported by experimental data, this type of comparison is inherently complex. Different models capture different aspects of biological systems, and even subtle variations in assumptions or parameter choices can lead to divergent behaviours. As such, the evaluation of biological plausibility should be interpreted with caution; it provides useful insight, but not definitive validation. The process of matching simulated outputs—such as concentration profiles and reaction kinetics—to literature values is valuable, yet inherently limited by the variability and uncertainty present in both modelling and experimental data.

The model simulates cytoplasmic molecular reactions within the geometry of a postsynaptic dendritic spine with a volume of 0.50588 $\mu\text{m}^3$. This volume matches the value used by @ordyan2020Interactions in their model of CaMKII in the postsynaptic density and falls within the physiological range of 0.004–0.6 $\mu\text{m}^3$ reported for hippocampal CA1 neurons [@harris1989Dendritica]. Tonnesen et al. (2018) reported a median spine volume of 0.1 $\mu\text{m}^3$, with some spines reaching up to 0.5 $\mu\text{m}^3$, supporting the plausibility of the volume chosen, albeit the volume is on the bigger end of the spectrum for dendritic spine volume. _In vivo_ calcium influx during synaptic input is often more complex, involving multiple calcium entry events and interactions with calcium-binding proteins.

The molecular concentrations used are also within biologically plausible ranges. For example, the initial release of 1000 $\mathrm{Ca^{2+}}$ ions corresponds to a concentration of 3.28 $\mu\text{M}$. Fluorescent $\mathrm{Ca^{2+}}$ indicator studies show resting intracellular $\mathrm{Ca^{2+}}$ concentrations between 0.05–0.1 $\mu\text{M}$, with increases up to 100-fold during stimulation (Grienberger et al., 2012; Maravall et al., 2000). Therefore, the calcium concentrations used are within ranges of stimulated neuronal activation. I discuss this further in the discussion section and future steps of the model. 

With respect to CaMKII, concentrations of CaMKIIα subunits have been reported to range between 5 and 100 $\mu\text{M}$ in neuronal dendrites [@lee2009Activation; @feng2011Quantitative; @otmakhov2012Measuring]. NMDARs are typically found at approximately 10 to 100 receptors per synapse [@petralia2012Distribution]. In the present model, the concentrations of CaMKII and NMDARs are positioned at the lower end of these reported ranges, primarily due to the relatively large spine volume modeled. Specifically, we include 290 CaMKII subunits (equivalent to 2.36 $\mu\text{M}$) and 30 NMDARs (0.099 $\mu\text{M}$). Although the concentration of CaMKII in this model is on the lower end of reported values, this choice remains valid given the larger spine volume incorporated in the model, which dilutes the concentration of CaMKII while maintaining a reasonable estimate for its overall abundance [REFERENCE]. Furthermore, the number of NMDARs in the model is within the reported range, reinforcing the biological relevance of the simulation. The limitations of these parameter choices and potential future directions for refining this model are further discussed in the Future Directions section.

PP1 concentrations in neurons are typically reported between 1 $\mu\text{M}$ and 10 $\mu\text{M}$ (REFERENCE Cohen, 2002), with CaMKII concentrations around 5 $\mu\text{M}$, yielding a literature-based ratio of approximately 5:1. In the model, PP1 is present at 0.039 $\mu\text{M}$, and CaMKII at 2.36 $\mu\text{M}$, resulting in a model ratio of about 60:1. While this higher CaMKII:PP1 ratio may exaggerate the kinase dominance. Higher PP1 concentrations should be considered in future iterations for a more accurate representation of the CaMKII:PP1 ratio, though the model remains useful for exploring activation dynamics and regulation under varying conditions.

These values are on the lower end of the reported ranges but remain within an order of magnitude of typical experimental data. This margin is reasonable, particularly given the experimental variability and the fact that many biological responses are robust to moderate concentration differences [REFERENCE]. Additionally, the relative abundance of these molecules is often more important than their absolute concentrations, as it governs the signaling dynamics. The values used in this model were taken from other computational models that have been validated against experimental biological data, ensuring that the concentrations are within the expected range based on observed physiological conditions. 

These values are consistent with those found in the literature and previous models that accurately represent the biological system at hand. Albeit, because the model uses a cell volume that is on the larger side for dendritic spines, the molecular concentrations are slightly lower than what others report [REFERENCES]. In the future, running the model with a slightly smaller cell volume would naturally increase the total observed molecular concentrations. However, the actual behavior of the molecules is not expected to change significantly, as the relative ratios of the molecules would remain the same. Thus, the signalling dynamics are expected to be largely unaffected by such changes in concentration.

## Incremental Construction and Stepwise Validation
In order to validate model behaviour, each reaction rule was added one at a time and tested to see if it produced biologically plausible results. Reactions or sets of reactions were introduced sequentially and tested independently. Structuring the model this way made it possible to validate individual components before integrating them into the full system. For example, the model was first tested by incorporating the calcium binding to CaM reactions. These were validated by comparing the outputs to those of a previously published and experimentally validated model [@romangarcia2017Computationala]. Once consistent behavior was observed, the next layer —CaM binding to CaMKII— was added and validated in a similar manner. Finally, interactions between CaMKII and NMDARs were introduced and tested. While a detailed account of each individual rule implementation is not provided here for the sake of conciseness, a summary of the key reaction layers and their expected outputs is presented in @tbl-model-predictions. Each row links an expected biological behaviour to its underlying model rule(s), along with an indication of whether the behaviour was observed in simulation results. These outputs not only confirm that the system produces plausible results at each stage but also serve as checkpoints for model development.

The list below presents a series of expected model behaviours that arise from specific reaction rules defined in the model, as per @fig-tbl-1 (in @sec-model-description). 

|Expected Result| Associated Reaction Rules | Observed in Models |
|-----------------|---------------------------------|-----------------------------|
|
$\mathrm{Ca^{2+}}$ binds to CaM in a stepwise manner, with higher affinity for forming CaM_Ca3 and CaM_Ca4 states. | Rules #1 - #4 (@fig-tbl-1)| Yes, see @fig-calcium-binding
|
CaMKII autophosphorylation at T286 is increased by binding to NMDARs. | Rules #5, #6, #8, #12 (@fig-tbl-1)| Yes, see |
|
CaM binds CaMKII only in its fully saturated state (CaM_Ca4), stabilizing CaMKII in its open conformation. | Rule #6 (@fig-tbl-1) |  Yes, see |
|
Open CaMKII binds to NMDARs, anchoring the kinase at the membrane .| Rule #12 (@fig-tbl-1) | Yes, see |
|
CaMKII undergoes autophosphorylation at T286 regardless of CaM binding, though this phosphorylation is enhanced by CaM binding.| Rule #8 (@fig-tbl-1)| Yes, see | 
|
CaMKII undergoes autophosphorylation at T306 following T286 phosphorylation. | Rules #8, #9 (@fig-tbl-1)| Yes, see |
|
CaMKII subunits can be found to be T306-phosphorylated and in a closed conformation. | Rules #5, #10 (@fig-tbl-1)| Yes, see |
|
PP1 dephosphorylates CaMKII at T286 and T306, reversing its activation and enabling cycling between open and closed states. | Rules #10, #11 (@fig-tbl-1)| Unclear, see |

: Summary of model predictions and expected results. {#tbl-model-predictions .striped tbl-colwidths="[70,15,15]"}

## Sanity Checks:
As part of the model validation process, a series of sanity checks were implemented to ensure the system behaved in accordance with known biochemical rules and structural constraints. These checks primarily aimed to verify that the model did not produce molecular species that are biologically implausible or explicitly forbidden by the reaction rules defined in the system.

Sanity checks were performed by recording observables in the BioNetGen Language (BNGL) model file. These observables are explicitly commented with justifications within the code itself and are structured to align with the logic and reaction rules outlined in @fig-tbl-1. The purpose of these observables is to serve as logical safeguards: if any of them yield a nonzero value during simulation, it indicates a breach of the model’s core assumptions or rule constraints. 

All sanity check observables listed above were expected to yield zero values, and did so consistently in simulation results. This confirms that the implemented reaction rules correctly prohibit the formation of biologically impossible species. These results are consistent and replicable; if the model is executed under the same rules and initial conditions, these observables are expected to remain zero in any future runs.

Below is a list of observables defined for sanity checks, along with a description of the corresponding molecular species, and an explanation of why their expected output should be zero under biologically valid conditions.

#### CaMKII_CaM_Ca4_PP {.unnumbered}
- Description: CaMKII bound to CaM (saturated with four Ca²⁺ ions), phosphorylated at both T286 and T306.
- Expected Output: 0
- Rationale: CaM binding and T306 phosphorylation are mutually exclusive. T306 lies within the CaM-binding domain of CaMKII, and its phosphorylation prevents CaM association. Thus, the coexistence of CaM and T306 phosphorylation is structurally impossible.

#### CaMKII_CaM_Ca4_T306P1 {.unnumbered}
- Description: CaMKII bound to Ca⁴⁺-CaM, phosphorylated at T306 only.
- Expected Output: 0
- Rationale: Similar to the case above, T306 phosphorylation sterically blocks CaM binding. Therefore, this species cannot exist under correct model logic.

#### CaMKII_CaM_closed {.unnumbered}
- Description: CaMKII bound to CaM_Ca4 while in a closed conformation.
- Expected Output: 0
- Rationale: CaM binding induces a conformational opening of CaMKII. Thus, the closed state is incompatible with CaM-bound configurations.

#### CaMKII_CaM_unbound_closed_T286P1 {.unnumbered}
- Description:  CaMKII phosphorylated at T286, unbound to CaM, and in a closed state.
- Expected Output: 0
- Rationale: Phosphorylation at T286 stabilizes the open conformation of CaMKII. Once phosphorylated at T286, the subunit is expected to remain open and cannot revert to the closed conformation.

#### CaMKII_closed_complex {.unnumbered}
- Description: CaMKII subunit is closed and bound to NMDAR forming NMDAR/CaMKII complex.
- Expected Output: 0
- Rationale: CaMKII can only bind to NMDARs if open and will remain open once bound, so none can be closed when bound in the NMDAR/CaMKII complex. 

Beyond molecular states which were expected to yield a value of zero, other sanity checks focused on conservation rules and population consistency. For example, if a simulation starts with 100 CaMKII subunits and 50% are phosphorylated at T286, the remaining 50% should be in unphosphorylated. Any deviation from this expected balance may indicate erroneous reaction pathways or state duplications. These sanity checks were observed during simulation results and cross-validated with the total molecule counts to ensure system integrity, as we will explore in @sec-results. 

## Qualitative Checks
In addition to direct rule-by-rule validation and formal sanity checks, qualitative checks were carried out to assess whether the model was capable of producing emergent behaviours consistent with known biological expectations—despite these behaviours not being explicitly hardcoded. These behaviours arise not from isolated reactions, but from the interaction and timing of multiple rules within the network, offering important insight into whether the system captures the complex, context-dependent behaviour observed in vivo.

For instance, phenomena such as the sustained opening of CaMKII following transient calcium signalling are not encoded as fixed outcomes. Instead, they should emerge from the model structure if the underlying mechanisms of encoded rules are implemented correctly. Similarly, the transition from CaM-dependent to CaM-independent anchoring at the NMDAR, are emergent outcomes expected to arise from the model’s rule interactions. The following emergent behaviours were not coded into the rules in @fig-tbl-1, but were expected behaviours to follow what is known in the literature. 

1. **CaMKII phosphorylation at T286 occurs regardless of CaM binding, although phosphorylation is more likely when CaM is present.** This behaviour is not explicitly hardcoded into the model, but is expected as an emergent property of the system. Both CaM binding and T286 phosphorylation stabilise the CaMKII subunit in its open conformation (rules #6 and #8), which increases the likelihood of both events co-occurring. Therefore, while the model does not directly specify this co-occurrence, the chances of T286 phosphorylation are indirectly increased when CaMKII is either already phosphorylated at T286 or bound to CaM, as both conditions promote an open state conducive to phosphorylation.

2. **When phosphorylated at T286, CaMKII binds more readily to NMDARs, independent of the presence of CaM.** This behaviour arises from the fact that T286 phosphorylation stabilises CaMKII in its open conformation, and only open CaMKII can bind to NMDARs. While the model does not explicitly encode a direct link between T286 phosphorylation and NMDAR binding, it encodes the conditions that promote each event separately. As a result, we expect that T286-phosphorylated CaMKII subunits will indirectly bind NMDARs more readily due to their maintained open state.

3. **When CaMKII is maintained in the open state by CaM binding, the kinase binds more readily to NMDARs and remains associated with the NMDAR/CaMKII complex even after CaM dissociates.** Both CaM binding and NMDAR binding stabilise CaMKII in its open conformation. The model allows multiple routes to maintaining this open state, one of them being CaM binding, hence CaM-bound CaMKII may be more likely to interact with NMDARs, and once that interaction occurs, the open conformation can be preserved by NMDAR binding alone. 

## Exploration of Uncertain Parameters
As discussed in @sec-intro-comp, computational models can serve as predictive tools to deepen our understanding of the mechanisms underlying observed biochemical processes. However, parameters such as rate constants, activation energies, diffusion coefficients, etcetera, are rarely known with precision [@sumathi2002Priori; @turanyi2012Determination; @mcdonald2022Parameter]. Consequently, predictions are typically subject to uncertainty. That is why understanding how parameter variations influence outcomes is a crucial part of model development and validation.

While other models have explored the dynamics of calcium, calmodulin, and CaMKII [@holmes2000Models; @lisman2001Model; @lisman2002Molecular; @zhabotinsky2000Bistability; @lucic2008Detaileda; @stefan2008Allostericd; @stefan2011MultiStage; @johnson2015Model; @pharris2019Multistate; @ordyan2020Interactions; @bartol2024Spatial], to the best of our knowledge none have specifically focused on the direct interactions between CaMKII and NMDARs, as is done in the present study. Consequently, determining parameters for calcium binding to CaM and CaM binding to CaMKII was relatively straightforward, as there are studies that have provided analyses and reviews of parameters that best fit biological phenomena [@linkevicius2025Fitting]. However, there were four reaction parameters that were more uncertain and key for this study: $k_{\text{on}} / k_{\text{off}}$ for CaMKII flicker of opening and closing, and $k_{\text{on}} / k_{\text{off}}$ for CaMKII binding to NMDARs.

Most models assume that CaM binding to CaMKII induces activation; however, this assumption is not applied in the current model, as discussed throughout this thesis. Pharris et al. [@pharris2019Multistate] have modelled the flickering of a CaMKII holoenzyme subunits, so we use their parameters but since the model used here integrates parameters from multiple sources, parameter exploration was conducted to identify values for the flickering dynamics that would yield robust and consistent results in alignment with the existing literature. Specifically, the opening and closing rates for CaMKII were tested by varying them by factors of 0.1, 1, and 0.01 relative to the values proposed by Pharris et al. [@pharris2019Multistate].

table of parameters used.

| CaMKII State | Factor | koff\_camkii\_close | kon\_camkii\_open | Kd = koff/kon |
|:------------:|:------:|:------------------:|:----------------:|:-------------:|
| open         | 1      | 1.00E+07            | 20000             | 500           |
| open         | 0.01   | 1.00E+05            | 200               | 500           |
| open         | 0.01   | 1.00E+05            | 200               | 500           |
| open         | 1      | 1.00E+07            | 20000             | 500           |
| open         | 0.1    | 1.00E+04            | 20                | 500           |
| open         | 0.1    | 1.00E+04            | 20                | 500           |
| closed       | 1      | 1.00E+07            | 20000             | 500           |
| closed       | 1      | 1.00E+07            | 20000             | 500           |
| closed       | 0.01   | 1.00E+05            | 200               | 500           |
| closed       | 0.01   | 1.00E+05            | 200               | 500           |
| closed       | 0.1    | 1.00E+06            | 2000              | 500           |
| closed       | 0.1    | 1.00E+06            | 2000              | 500           |


Similarly, parameter variations for the CaMKII and NMDAR binding rates were explored. We found a $k_{\text{off}}$ for the unbinding of CaMKII from the NR1 subunit of NMDARs, albeit not for the GluN2B subunit that CaMKII is known to bind more readily too. Very recently, a new study published a proposed dissociation constant ($k_{\text{D}}$) or CaMKII/GLuN2B binding. Yet, we did not know a $k_{\text{off}}$ and wanted to see if changing these parameyters changed the model much. 

since we knew kd and koff, we varied kon by factor of 1, 0.1 and 0.01 

To quantify how these parameter changes affect model predictions, the influence of the four key input parameters on the model’s output behaviour was carefully examined.  Specifically, the goal was to assess how variations in these rate constants influenced system outputs such as the concentrations of CaMKII T286 phosphorylation, total CaMKII opening, NMDAR binding over time, and the likelihood of specific reaction outcomes. This was achieved by varying one set of parameter at a time while keeping others constant, allowing for an assessment of each set of parameter's individual impact.

The approach taken involved the following steps:

First, the model was tested by varying the kon/koff for CaMKII opening and closing, keeping the Kd constant. The rates were altered by factors of 0.1, 1, and 10, with all other reactions held constant.

Once the factor of 1 was selected, runs were performed to change the koff for CaMKII binding to NMDARs. This was the most uncertain parameter, as although a kon was identified (albeit for NR1, not NR2B), no koff had been proposed. The koff value was varied to observe the effect of changing the Kd. Ultimately, a Kd value of approximately 1e-7 was found to match the expected range, and this value was subsequently used in the model.

![](validation-figures\all_variables_plot.png)

## Reproducibility and model robustness
_Write about the different ways in which CaMKII is instantiated in different runs._

## specs and reproducibility

the model is run with x y files and theese is where everything is. 