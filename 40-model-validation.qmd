# Validating model behaviour {#sec-validating-model}

In order to validate the model, I did five main things: 

1-> model closeness to reality, biological plausibility.
2-> model was built incrementally

4 -> Kinetic parameters used in the model's reactions were sourced from the literature or inferred from experimental data where available. In cases of uncertainty, parameter exploration was conducted to assess how kinetic rates impact model behaviour (see @sec-SA).

## Biological Plausibility
While care was taken to compare model outputs with known biological processes described in the literature and supported by experimental data, this type of comparison is inherently complex. Different models capture different aspects of biological systems, and even subtle variations in assumptions or parameter choices can lead to divergent behaviours.

As such, the evaluation of biological plausibility should be interpreted with caution; it provides useful insight, but not definitive validation. The process of matching simulated outputs—such as concentration profiles and reaction kinetics—to literature values is valuable, yet inherently limited by the variability and uncertainty present in both modelling and experimental data.

### Model Geometry and Concentrations
The model simulates cytoplasmic molecular reactions within the geometry of a postsynaptic dendritic spine with a volume of 0.50588 $\mu\text{m}^3$.  This volume matches the value used by @ordyan2020Interactions in their model of CaMKII in the postsynaptic density and falls within the physiological range of 0.004–0.6 $\mu\text{m}^3$reported for hippocampal CA1 neurons (Harris et al., 1989). Tonnesen et al. (2018) reported a median spine volume of 0.1 $\mu\text{m}^3$, with some spines reaching up to 0.5 $\mu\text{m}^3$, supporting the plausibility of the volume chosen.

The molecular concentrations used are also within biologically plausible ranges. For example, the initial release of 1000 Ca²⁺ ions corresponds to a concentration of 3.28 μM. Fluorescent $\mathrm{Ca^{2+}}$ indicator studies show resting intracellular $\mathrm{Ca^{2+}}$ concentrations between 0.05–0.1 $\mu\text{M}$, with increases up to 100-fold during stimulation (Grienberger et al., 2012; Maravall et al., 2000). Therefore, the calcium concentrations used are consistent with simulated neuronal activation.

Similarly, CaM concentrations reported in the literature range from 0.1 to 8 $\mu\text{M}$, with some reports suggesting levels up to 250 $\mu\text{M}$. The model uses a concentration of 0.98 μM, which is within this range. Experimental estimates place CaMKII concentrations in dendritic spines around 5 μM, with NMDAR concentrations reported at approximately 0.17 μM (Lisman et al., 2012; Petralia et al., 2009), yielding a literature-based ratio of roughly 29:1. In the current model, CaMKII is present at 2.36 $\mu\text{M}$, and NMDARs at 0.099 $\mu\text{M}$, giving a model ratio of about 24:1. This close correspondence demonstrates that the functional relationship between CaMKII and NMDARs is preserved, even if the absolute concentrations are slightly reduced. PP1 concentrations in neurons are typically reported between 1 μM and 10 μM (Cohen, 2002), with CaMKII concentrations around 5 $\mu\text{M}$, yielding a literature-based ratio of approximately 5:1. In the model, PP1 is present at 0.039 $\mu\text{M}$, and CaMKII at 2.36 $\mu\text{M}$, resulting in a model ratio of about 60:1. While this higher CaMKII:PP1 ratio may exaggerate the kinase dominance. Higher PP1 concentrations should be considered in future iterations for a more accurate representation of the CaMKII:PP1 ratio, though the model remains useful for exploring activation dynamics and regulation under varying conditions.

These values are on the lower end of the reported ranges but remain within an order of magnitude of typical experimental data. This margin is reasonable, particularly given the experimental variability and the fact that many biological responses are robust to moderate concentration differences [REFERENCE]. Additionally, the relative abundance of these molecules is often more important than their absolute concentrations, as it governs the signaling dynamics. The values used in this model were taken from other computational models that have been validated against experimental biological data, ensuring that the concentrations are within the expected range based on observed physiological conditions. 

These values are consistent with those found in the literature and previous models that accurately represent the biological system at hand. Albeit, because the model uses a cell volume that is on the larger side for dendritic spines, the molecular concentrations are slightly lower than what others report [REFERENCES]. In the future, running the model with a slightly smaller cell volume would naturally increase the total observed molecular concentrations. However, the actual behavior of the molecules is not expected to change significantly, as the relative ratios of the molecules would remain the same. Thus, the signalling dynamics are expected to be largely unaffected by such changes in concentration.

## Incremental Construction and Stepwise Validation
In order to validate model behaviour, each reaction rule was added one at a time and tested to see if it produced biologically relevant results. Reactions or sets of reactions were introduced sequentially and tested independently. Structuring the model this way made it possible to validate individual components before integrating them into the full system.

For example, the model was first tested by incorporating the calcium binding to calmodulin (CaM) reactions. These were validated by comparing the outputs to those of a previously published and experimentally validated model [REFERENCE]. Once consistent behavior was observed, the next layer—CaM binding to CaMKII—was added and validated in a similar manner. Finally, interactions between CaMKII and NMDARs were introduced and tested.

By using previously validated models as benchmarks at each stage, confidence in the biological accuracy of the newly constructed system was enhanced. This approach also ensured that complex interactions were introduced gradually, minimizing the risk of errors and improving the interpretability of the simulation results. While a detailed, step-by-step account of each reaction is not provided here for the sake of clarity and conciseness, a summary of the model reactions and the expected confirmed outputs can be found in the table below.

Note that not all steps are shown here—for instance, I initially tested CaMKII as a hexamer before constructing the full dodecamer to ensure the functionality of the multistate molecule. This was a critical step, but the results of these intermediate tests are not included, as they were part of the model-building process. Additionally, I conducted tests before adding NMDARs, which were modeled as surface molecules and required specialized testing. Once this testing was completed, I confirmed the interaction between CaMKII and NMDARs.

|Expected Result| Associated Reaction Rules | Observed in Models |
|-----------------|---------------------------------|-----------------------------|
|
$\mathrm{Ca^{2+}}$ binds to CaM in a stepwise manner, with higher affinity for forming CaM\_Ca3 and CaM\_Ca4 states [REFERENCE]. | Rules #1 – #4 (@fig-tbl-1)| Yes, see @fig-calcium-binding
|
CaMKII subunits flicker between open and closed and are stabilised in open conformation by T286 phosphorylation, CaM binding and/or NMDAR binding. | Rules #5, #6, #8, #12 (@fig-tbl-1)| Yes, see |
|
CaM binds CaMKII only in its fully saturated state (CaM_Ca4), stabilizing CaMKII in its open conformation [REFERENCE]. | Rule #6 |  Yes, see |
|
Open CaMKII binds to NMDARs, anchoring the kinase at the membrane  [REFERENCE].| Rule #12  | Yes, see |
|
CaMKII undergoes autophosphorylation at T286 regardless of CaM binding, though this phosphorylation is enhanced by CaM binding [REFERENCE].| Rule #8 | Yes, see | 
|
CaMKII undergoes autophosphorylation at T306 following T286 phosphorylation [REFERENCE]. | Rules #8, #9 | Yes, see |
|
CaMKII subunits can be found to be T306-phosphorylated and in a closed conformation [REFERENCE]. | Rules #5, #10 | Yes, see |
|
PP1 dephosphorylates CaMKII at T286 and T306, reversing its activation and enabling cycling between open and closed states. [REFERENCE]. | Rules #10, #11 | Unclear, see |

: Summary of Model Predictions and Results. {#tbl-model-predictions .striped tbl-colwidths="[60,20,20]"}



Summary of above table.

## Exploration of Uncertain Parameters
As discussed in @sec-intro-comp, computational models can serve as predictive tools to deepen our understanding of the mechanisms underlying observed biochemical processes. However, parameters such as rate constants, activation energies, thermodynamic constants, transport coefficients, etcetera, are rarely known with precision [REFERENCE]. Consequently, predictions are typically subject to uncertainty. That is why understanding how parameter variations influence outcomes is a crucial part of model development and validation.

While other models have explored the dynamics of calcium, calmodulin, and CaMKII, to the best of our knowledge none have specifically focused on the direct interactions between CaMKII and NMDARs, as is done in the present study. Consequently, determining parameters for calcium binding to CaM and CaM binding to CaMKII was relatively straightforward, as there are studies that have provided analyses and reviews of parameters that best fit biological phenomena [REFERENCE]. However, there were four reaction parameters that were more uncertain and key for this study: $k_{\text{on}} / k_{\text{off}}$ for camkii opening and closing, and $k_{\text{on}} / k_{\text{off}}$ for CaMKII binding to NMDARs.

Most models assume that CaM binding to CaMKII induces activation; however, this assumption is not applied in the current model, as discussed throughout this thesis. To our knowledge, Pharris et al. are the only ones who have modelled the flickering of CaMKII between open and closed states. Since the model used here integrates parameters from multiple sources, parameter exploration was conducted to identify values for the flickering dynamics that would yield robust and consistent results in alignment with the existing literature. Specifically, the opening and closing rates for CaMKII were tested by varying them by factors of 0.1, 1, and 10 relative to the values proposed by Pharris et al. [REFERENCE].

table of parameters used.

Similarly, parameter variations for the CaMKII and NMDAR binding rates were explored. We found a $k_{\text{off}}$ for the unbinding of CaMKII from the NR1 subunit of NMDARs, albeit not for the GluN2B subunit that CaMKII is known to bind more readily too. Very recently, a new study published a proposed dissociation constant ($k_{\text{D}}$) or CaMKII/GLuN2B binding. Yet, we did not know a $k_{\text{off}}$ and wanted to see if changing these parameyters changed the model much. 

To quantify how these parameter changes affect model predictions, the influence of the four key input parameters on the model’s output behaviour was carefully examined.  Specifically, the goal was to assess how variations in these rate constants influenced system outputs such as the concentrations of CaMKII T286 phosphorylation, total CaMKII opening, NMDAR binding over time, and the likelihood of specific reaction outcomes. This was achieved by varying one set of parameter at a time while keeping others constant, allowing for an assessment of each set of parameter's individual impact.

The approach taken involved the following steps:

First, the model was tested by varying the kon/koff for CaMKII opening and closing, keeping the Kd constant. The rates were altered by factors of 0.1, 1, and 10, with all other reactions held constant.

Once the factor of 1 was selected, runs were performed to change the koff for CaMKII binding to NMDARs. This was the most uncertain parameter, as although a kon was identified (albeit for NR1, not NR2B), no koff had been proposed. The koff value was varied to observe the effect of changing the Kd. Ultimately, a Kd value of approximately 1e-7 was found to match the expected range, and this value was subsequently used in the model.

## Sanity checks:
As part of the model validation process, a series of sanity checks were implemented to ensure the system behaved in accordance with known biochemical rules and structural constraints. These checks primarily aimed to verify that the model did not produce molecular species that are biologically implausible or explicitly forbidden by the reaction rules defined in the system.

Sanity checks were performed by recording observables in the BioNetGen Language (BNGL) model file. These observables are explicitly commented with justifications within the code itself and are structured to align with the logic and reaction rules outlined in @fig-tbl-1. The purpose of these observables is to serve as logical safeguards: if any of them yield a nonzero value during simulation, it indicates a breach of the model’s core assumptions or rule constraints. 

All sanity check observables listed above were expected to yield zero values, and did so consistently in simulation results. This confirms that the implemented reaction rules correctly prohibit the formation of biologically impossible species. These results are consistent and replicable; if the model is executed under the same rules and initial conditions, these observables are expected to remain zero in any future runs.

Below is a list of observables defined for sanity checks, along with a description of the corresponding molecular species, and an explanation of why their expected output should be zero under biologically valid conditions.

#### CaMKII_CaM_Ca4_PP
- Description: CaMKII bound to CaM (saturated with four Ca²⁺ ions), phosphorylated at both T286 and T306.
- Expected Output: 0
- Rationale: CaM binding and T306 phosphorylation are mutually exclusive. T306 lies within the CaM-binding domain of CaMKII, and its phosphorylation prevents CaM association. Thus, the coexistence of CaM and T306 phosphorylation is structurally impossible.

#### CaMKII_CaM_Ca4_T306P1
- Description: CaMKII bound to Ca⁴⁺-CaM, phosphorylated at T306 only.
- Expected Output: 0
- Rationale: Similar to the case above, T306 phosphorylation sterically blocks CaM binding. Therefore, this species cannot exist under correct model logic.

#### CaMKII_CaM_closed
- Description: CaMKII bound to CaM_Ca4 while in a closed conformation.
Expected Output: 0
Rationale: CaM binding induces a conformational opening of CaMKII. Thus, the closed state is incompatible with CaM-bound configurations.

#### CaMKII_CaM_unbound_closed_T286P1
- Description:  CaMKII phosphorylated at T286, unbound to CaM, and in a closed state.
- Expected Output: 0
- Rationale: Phosphorylation at T286 stabilizes the open conformation of CaMKII. Once phosphorylated at T286, the subunit is expected to remain open and cannot revert to the closed conformation.

#### CaMKII_closed_complex
- Description: CaMKII subunit is closed and bound to NMDAR forming NMDAR/CaMKII complex.
- Expected Output: 0
- Rationale: CaMKII can only bind to NMDARs if open and will remain open once bound, so none can be closed when bound in the NMDAR/CaMKII complex. 


Beyond molecular states which were expected to yield a value of zero, other sanity checks focused on conservation rules and population consistency. For example, if a simulation starts with 100 CaMKII subunits and 50% are phosphorylated at T286, the remaining 50% should be in unphosphorylated. Any deviation from this expected balance may indicate erroneous reaction pathways or state duplications. These sanity checks were observed during simulation results and cross-validated with the total molecule counts to ensure system integrity, as we will explore in @sec-results.

--
As part of the validation process, sanity checks were implemented to ensure that the model behaved in a biologically reasonable manner across a wide range of conditions. These checks primary aim was to ensure that the model adhered to known biochemical constraints and reaction rules.

The sanity checks looked like looking for molecules that we know are not "allowed" to happen in the model according to the set reaction rules. 

The sanity checks were focused on ensuring that molecules which could not exist due to reaction constraints and biological principles, were not produced by the model. For instance, certain molecules, like cam_camkii_t306p, were expected to have a concentration of zero, or in other words, to not exist in the model, as the T306 phosphorylation site on CaMKII cannot be phosphorylated when the CAMKII subunit is bound to calmodulin.

say that this is done through recording of observables in bngl file? and are commented with exact reasonings in the file itself too. these are all observables that are for sanity checks and make sense whn looking at @fig-tbl-1 logic of rules. 

- CaMKII_CaM_Ca4_PP, which means camkii is bound to cam and phosphorylated at both t286 and t306. should be zero, as camkii subunit cant be phosphorylated at t306 and be bound to cam
- CaMKII_CaM_Ca4_T306P1, same reason as above, cam and t306 cannot coexist.
- CaMKII_CaM_closed, when camkii is bound to cam, camkii cannot close, so this observable should be zero. 
- CaMKII_CaM_unbound_closed_T286P1
- CaMKII_closed_complex 
- CaMKII_CaM_Ca4_PP_bound_NMDAR 
- CaMKII_CaM_Ca4_T306P1_bound_NMDAR

all these molecules were checked and are added in the code for observables. 

there are others that i havent done, how do i argue why yes or why not? 

then there are other types of sanity checks, like for example if there are 100 molecules of camkii, and 50% of them are phosphorylated, then the rest should be unphosohorylated. we see some of these in the results. 

![alt text](40-results-figures/WT/subsets-of-camkii-t286p-cam-binding.png)

## Reproducibility and model robustness
_Write about the different ways in which CaMKII is instantiated in different runs._

## specs and reproducibility

the model is run with x y files and theese is where everything is. 